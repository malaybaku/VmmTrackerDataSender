<Window x:Class="VmmTrackerWpf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="VMM Tracker Receiver (WPF)" Height="700" Width="500"
        Closing="Window_Closing">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Row 0: Format selection + Start button -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,8">
            <TextBlock Text="Format:" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <ComboBox x:Name="FormatComboBox" Width="120" SelectedIndex="0" Margin="0,0,16,0">
                <ComboBoxItem Content="compressed"/>
                <ComboBoxItem Content="readable"/>
            </ComboBox>
            <Button x:Name="StartButton" Content="接続開始" Width="100" Click="StartButton_Click"/>
        </StackPanel>

        <!-- Row 1: Connection status -->
        <TextBlock Grid.Row="1" x:Name="StatusText" Text="未接続" FontSize="14" FontWeight="Bold"
                   Margin="0,0,0,8"/>

        <!-- Row 2: QR Code image -->
        <Border Grid.Row="2" BorderBrush="Gray" BorderThickness="1" Margin="0,0,0,8"
                HorizontalAlignment="Center" Visibility="{Binding ElementName=QrImage, Path=Source, Converter={x:Null}}">
            <Image x:Name="QrImage" Width="256" Height="256" Stretch="Uniform"
                   RenderOptions.BitmapScalingMode="NearestNeighbor"/>
        </Border>

        <!-- Row 3: URL display + copy -->
        <DockPanel Grid.Row="3" Margin="0,0,0,8" x:Name="UrlPanel" Visibility="Collapsed">
            <Button DockPanel.Dock="Right" Content="Copy" Width="50" Margin="8,0,0,0"
                    Click="CopyUrlButton_Click"/>
            <TextBox x:Name="UrlTextBox" IsReadOnly="True" VerticalContentAlignment="Center"
                     FontSize="10"/>
        </DockPanel>

        <!-- Row 4: Fetch Answer button -->
        <Button Grid.Row="4" x:Name="FetchAnswerButton" Content="Answer取得" Width="120"
                HorizontalAlignment="Left" Margin="0,0,0,8" Visibility="Collapsed"
                Click="FetchAnswerButton_Click"/>

        <!-- Row 5: Tracking data display -->
        <ScrollViewer Grid.Row="5" VerticalScrollBarVisibility="Auto" Margin="0,0,0,8">
            <TextBlock x:Name="TrackingDataText" FontFamily="Consolas" FontSize="12"
                       TextWrapping="Wrap"/>
        </ScrollViewer>

        <!-- Row 6: Log area -->
        <Expander Grid.Row="6" Header="ログ" IsExpanded="False">
            <ScrollViewer Height="120" VerticalScrollBarVisibility="Auto">
                <TextBlock x:Name="LogText" FontFamily="Consolas" FontSize="10"
                           TextWrapping="Wrap"/>
            </ScrollViewer>
        </Expander>
    </Grid>
</Window>
